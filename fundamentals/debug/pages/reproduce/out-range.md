# 일반적인 범위에서 벗어나도록 재현하기

개발을 하다 보면 외부에서 들어오는 값을 그대로 믿기 어려운 상황이 자주 생겨요. 값이 너무 작거나 너무 커서 예상을 벗어나면, 시스템이 오작동하거나 예외가 발생할 수 있어요. 또 값 자체는 문제없지만, **경계 조건**을 제대로 처리하지 않아서 에러로 이어지는 경우도 많아요.

이번에 소개할 방법은 이런 상황을 **일부러 유도해서 문제를 드러내는 디버깅 기법**이에요. 시스템이 **취약하거나 예외 처리가 부족한 부분을 찾아내기 쉽게 해주고**, 문제 상황을 **강제로 만들 수 있기 때문에**, 버그를 빠르게 재현할 수 있어요.

크게 두 가지 범위에 대해 이야기해볼게요.

1. **경계값**: 정상과 비정상의 경계에 있는 값을 테스트해서 오류를 찾는 전략이에요.
2. **예상보다 큰 값 또는 작은 값**: 정상 범위를 벗어난 아주 큰 값이나 아주 작은 값으로 테스트해서 오류를 찾는 전략이에요.

## 경계값 - 숫자

먼저 **경계값(boundary value)**에 대해 이야기해볼게요. 경계값 테스트는 정상 입력의 양 끝 지점을 중심으로 발생할 수 있는 문제를 발견하는 데 효과적인 전략이에요. 주로 **범위의 끝에 위치한 값들**, 즉 경계에서 ±1 정도의 값을 넣어 테스트해요.

예를 들어, 아래처럼 이름을 최대 10자까지 입력할 수 있는 입력창이 있다고 할 때 다음 세 가지 경우를 테스트하는 게 좋아요.

- 입력 0자 (빈 문자열)
- 정확히 10자
- 11자 (제한 초과)

```tsx
function NameInput() {
  const [name, setName] = React.useState('');

  const handleChange = (e) => {
    if (e.target.value.length > 10) return;
    setName(e.target.value);
  };

  return (
    <>
      <input value={name} onChange={handleChange} />
      <p>{name.length}/10</p>
    </>
  );
}
```

## 경계값 - 날짜
숫자뿐 아니라 **날짜**에서도 경계값 조건은 자주 등장해요. 다음은 실제로 제품 개발에서 자주 요구되는 날짜 관련 조건들이에요. 경계값 처리가 잘못되면 사용자 입장에선 혼란을 느끼거나, 의도와 다르게 동작할 수 있어요.

| 상황 | 조건 |
| --- | --- |
| **"3일 이내에 로그인해야 함"** | 오늘 포함해서 3일 범위 |
| **"이벤트는 5일 전까지만 참여 가능"** | 오늘 포함 X, 5일 초과는 제외 |
| **"쿠폰은 발급일 기준 7일까지 유효"** | 7일째 되는 날까지 유효 |
| **"오늘 이후 예약만 가능"** | 오늘은 불가능, 내일부터 허용 |
| **"지난 날짜는 비활성화" (캘린더)** | 오늘보다 이전이면 비활성화 |

그럼 실제로 경계값을 테스트하는 방법을 살펴볼게요. 아래는 `date-fns` 라이브러리를 사용해서, 주어진 날짜가 **오늘 포함 3일 전 이내인지 확인하는 함수**예요. 아래 코드와 같이 다양한 날짜 값을 넣어서 테스트할 수 있어요.

```tsx 6
import { differenceInCalendarDays, format } from 'date-fns';

function is오늘포함3일전(date: Date) {
  const today = new Date();
  const diff = differenceInCalendarDays(today, date);
  return diff <= 3;
}

const today = new Date('2025-04-27');

const testDates = [
  new Date('2025-04-28'), 
  new Date('2025-04-27'), 
  new Date('2025-04-26'), 
  new Date('2025-04-23'),
];

testDates.forEach((date) => {
  console.log({ date, isValid:is오늘포함3일전(date) });
});
```



이처럼 **경계값은 예상치 못한 에러가 가장 많이 발생하는 지점**이에요. 이런 값들을 미리 테스트해두면 안정성과 사용자 경험을 모두 향상시킬 수 있어요.

## 예상보다 큰 값 혹은 작은 값

이번에는 **예상 범위를 벗어나는 값**으로 테스트하는 방법을 소개할게요. 코드가 정상적으로 작동하리라 가정하고 넘어가기 쉬운 부분이지만, 실제 사용자 입력은 언제든 예외적인 값을 포함할 수 있어요.

예를 들어, **양수만 입력된다고 가정하고 음수 처리를 빠뜨리는 경우**가 있어요. 아래 코드는 가격이 음수일 때 에러를 발생시키도록 처리한 예시예요.

```tsx
function calculateDiscount(price) {
  if (price < 0) {
    throw new Error('가격은 음수일 수 없습니다');
  }
  return price > 10000 ? 0.2 : 0.1;
}

calculateDiscount(-500);
```

이처럼 입력 값의 조건을 명확히 하지 않으면, 시스템은 예상치 못한 동작을 하거나 오류 없이 잘못된 결과를 반환할 수 있어요.


## 그 외 범위를 벗어난 값
숫자의 최대값, 최소값 같은 **극단적인 값**으로도 테스트해볼 수 있어요. 이런 값을 테스트하면, 숫자 오버플로우(overflow)나 정밀도 손실 같은 문제가 발생하는지 확인할 수 있어요.
    

```tsx
const numbers = [Number.MAX_SAFE_INTEGER, Number.MIN_SAFE_INTEGER];
calculateDiscount(Math.max(...numbers));
```


"이 값은 절대 안 들어올 거야"라고 생각하는 순간, 버그는 그 틈을 타고 들어와요. 예상보다 작은 값이나 큰 값을 미리 테스트해두면, 에러를 미리 차단하고 더 튼튼한 시스템을 만들 수 있어요.